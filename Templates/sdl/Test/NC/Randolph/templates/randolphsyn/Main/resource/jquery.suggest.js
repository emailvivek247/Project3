(function(a){a.suggest=function(o,g){var c=a(o).attr("autocomplete","off");var f=a(document.createElement("ul"));var n=false;var d=-1;var q=[];var p=0;f.addClass(g.resultsClass).appendTo("body");j();a(window).load(j).resize(j);c.blur(function(){setTimeout(function(){f.hide()},200)});try{f.bgiframe()}catch(s){}if(a.browser.mozilla){c.keypress(m)}else{c.keydown(m)}function j(){var e=c.offset();f.css({top:(e.top+o.offsetHeight)+"px",left:e.left+"px",width:c.width()+"px"})}function m(x){if((/27$|38$|40$/.test(x.keyCode)&&f.is(":visible"))||(/^13$|^9$/.test(x.keyCode)&&v())){if(x.preventDefault){x.preventDefault()}if(x.stopPropagation){x.stopPropagation()}x.cancelBubble=true;x.returnValue=false;switch(x.keyCode){case 38:k();u();break;case 40:t();u();break;case 9:case 13:r();a(this).parents("form")[0].submit();break;case 27:f.hide();break}}else{if(c.val().length!=d){if(n){clearTimeout(n)}n=setTimeout(l,g.delay);d=c.val().length}}}function l(){var y=c.val();for(var e=0;e<y.length;e++){if(y.charAt(e)!=" "){y=y.substring(e,y.length);break}}var x=y;if(x.length>=g.minchars){cached=w(x);if(cached){i(cached.items)}else{a.get(g.source,{q:x},function(z){f.hide();var A=b(z,x);i(A);h(x,A,z.length)})}}else{f.hide()}}function w(x){for(var e=0;e<q.length;e++){if(q[e]["q"]==x){q.unshift(q.splice(e,1)[0]);return q[0]}}return false}function h(z,e,x){while(q.length&&(p+x>g.maxCacheSize)){var y=q.pop();p-=y.size}q.push({q:z,size:x,items:e});p+=x}function i(e){if(!e){return}if(!e.length){f.hide();return}var y="";for(var x=0;x<e.length;x++){y+="<li>"+e[x]+"</li>"}f.html(y).show();f.children("li").mouseover(function(){f.children("li").removeClass(g.selectClass);a(this).addClass(g.selectClass)}).click(function(z){z.preventDefault();z.stopPropagation();r()})}function b(e,A){var x=[];var B=e.split(g.delimiter);for(var z=0;z<B.length;z++){var y=a.trim(B[z]);if(y){y=y.replace(new RegExp(A,"ig"),function(C){return'<span class="'+g.matchClass+'">'+C+"</span>"});x[x.length]=y}}return x}function v(){if(!f.is(":visible")){return false}var e=f.children("li."+g.selectClass);if(!e.length){e=false}return e}function r(){$currentResult=v();if($currentResult){c.val($currentResult.text());f.hide();if(g.onSelect){g.onSelect.apply(c[0])}}}function u(){$currentResult=v();if($currentResult){c.val($currentResult.text())}}function t(){$currentResult=v();if($currentResult){$currentResult.removeClass(g.selectClass).next().addClass(g.selectClass)}else{f.children("li:first-child").addClass(g.selectClass)}}function k(){$currentResult=v();if($currentResult){$currentResult.removeClass(g.selectClass).prev().addClass(g.selectClass)}else{f.children("li:last-child").addClass(g.selectClass)}}};a.fn.suggest=function(c,b){if(!c){return}b=b||{};b.source=c;b.delay=b.delay||100;b.resultsClass=b.resultsClass||"ac_results";b.selectClass=b.selectClass||"ac_over";b.matchClass=b.matchClass||"ac_match";b.minchars=b.minchars||1;b.delimiter=b.delimiter||"\n";b.onSelect=b.onSelect||false;b.maxCacheSize=b.maxCacheSize||65536;this.each(function(){new a.suggest(this,b)});return this}})(jQuery);