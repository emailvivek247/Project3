<#--Link jquery files for textbox/dropdown combo box-->

<script type="text/javascript" src="<@com.currentUrlPrefix/>/resource/jquery-ui-1.8.22.custom.min.js"></script>

<#--Style for textbox/dropdown combo box-->
<style>
    #RecDateLabelFrom{
        font-size:13px;
        color:#777777;
        width: 140px;
    display: block;
        text-align: right;
    }
    #RecDateLabelTo{
    font-size:13px;
    color:#777777;
    width: 123px;
        display: block;
        text-align: right;
    }
.ui-combobox-toggle {
        position: relative;
        top: 6;
        bottom: 0;
        margin-left: -1px;
        padding: 3.5px;
        /* adjust styles for IE 6/7 */
        *height: 1.4em;
        *top: -0.25em;
    }
    .ui-combobox-input {
        margin: 0px 0 2px 2px;
        padding: 0.1em;
    }
</style>

<script type="text/javascript">

// *Set values for searchable fields
var searchfields = "WebName,ExactName,NameSort,Instrument,RecDate,PartyRole,IndexType,DocType,Book,Page,LotNum,Unit,SectionNum,Subdivision,Township,Other,DesigStatus,GPIN,ProjectNum,RdNum,Desc2,Desc3,Phase,Acreage,Building";
var phoneticfields = "WebPhoneticName,ExactName,PhoneticNameSort,Instrument,RecDate,PartyRole,IndexType,DocType,Book,Page,LotNum,Unit,SectionNum,Subdivision,Township,Other,DesigStatus,GPIN,ProjectNum,RdNum,Desc2,Desc3,Phase,Acreage,Building";

    function unique(arrayName) {
            var newArray=new Array();
            label:for(var i=0; i<arrayName.length;i++ )
            {  
                for(var j=0; j<newArray.length;j++ ) {
                    if(newArray[j].name == arrayName[i].name) 
                     continue label;
                }
                //*setCookie('Main' + arrayName[i].name, jQuery.trim(arrayName[i].value), 0);
                if ((arrayName[i].type == 'text' || arrayName[i].type == 'select-one') && jQuery.trim(arrayName[i].value).length != 0) {
                    newArray[newArray.length] = arrayName[i];
                }
            }
                //*setCookie('MainfrmRecDate', document.getElementById('frmRecDate').value, 0);
                //*setCookie('MaintoRecDate',  document.getElementById('toRecDate').value, 0);
            return newArray;
        }   
        function postAdvancedSearch() {
                try {
                    if ($('input[name=searchkind]:checked').val() == null || $('input[name=searchkind]:checked').val() == "") {
                    $('input[name=searchkind]:nth(0)').attr("checked","checked");
                 } 
            if ($('input[name=suggestion]:checked').val() == null || $('input[name=suggestion]:checked').val() == "") {
              $('input[name=suggestion]:nth(0)').attr("checked","checked");
            } 
                    if (!doDateCheck('frmRecDate','toRecDate'))return;
                    document.getElementById("q").value = '';
                    var inputElemenets =  $('input[type="text"],select#DocTypeDesc,select#combobox');
                    var elem = unique(inputElemenets);
                    var searchString = '';
                    var searchQuery = '';
                    var andOrClause ='';
                    var doubleQuotes = '"';
                    var counter = 0;
                    var textcounter = 0;
                    var searchValue = '';
                    var searchValueQuery = '';
                    var hasSpecialNames = 'N';
                    var enhancingValue = '';
                    for(var i = 0; i < elem.length; i++) {
                        if (document.getElementById(elem[i].name + '_select') != null) {
                            counter++;  
                        }                   
                    }
                    setCookie('searchkind', $('input[name=searchkind]:checked').val(), 0);
                    setCookie('suggestion', $('input[name=suggestion]:checked').val(), 0);
                    for(var i = 0; i < elem.length; i++) {
                        if (document.getElementById(elem[i].name + '_select') != null) {
                            setCookie('Main' + elem[i].name + '_select', document.getElementById(elem[i].name + '_select').selectedIndex, 0);
                            textcounter++
                            if (textcounter == counter) {
                                andOrClause = '';
                            } else {
                                andOrClause = ' ' + document.getElementById(elem[i].name + '_select').value + '  ';
                            }
                            if (elem[i].name == 'RecDate') {
                                searchValue = getDateQuery(elem[i].name);
                                searchValueQuery = getDateSearchQuery(elem[i].name);
                            } else if (elem[i].name == 'NameSort') {
                                searchValue = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                                searchValue = '#' + searchValue + '#';
                                searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                            } else if (elem[i].name == 'WebName') {                        
                                if ($('input[name=searchkind]:checked').val() == 'Exact') {
                                     searchValue = 'ExactName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                                     searchValue = '#' + searchValue + '#';
                                     searchValueQuery = 'Name' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                           } else if ($('input[name=searchkind]:checked').val() == 'Similar') {
                                     enhancingValue = 'NameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value).toLowerCase() + doubleQuotes;
                                     if (textcounter == counter) {
                                         enhancingValueCondition = '';
                                     } else {
                                         enhancingValueCondition = ' ' + document.getElementById(elem[i].name + '_select').value + '  ';
                                           
                                     }
                                     hasSpecialNames = 'Y';  
                                     searchValue = 'NameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                         searchValue = '#' + searchValue + '#';
                                     searchValueQuery = 'Name' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                           } else if ($('input[name=searchkind]:checked').val() == 'Contains') {
                                 searchValue = '(' + '#' + elem[i].name + ':' + doubleQuotes + jQuery.trim(removeNonAlphaNumChar(elem[i].value)) + doubleQuotes + '#' + ' OR ';
                                 searchValue = searchValue + '#' + elem[i].name + ':' + doubleQuotes + "*" + jQuery.trim(removeNonAlphaNumCharRetainSpaces(elem[i].value)) + "*" + doubleQuotes + '#' + ' OR ';
                                 searchValue = searchValue + '#' + 'BasicName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5' + ')';
                                 searchValueQuery = 'Name' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;  
                           
                           } else if ($('input[name=searchkind]:checked').val() == 'Starts') {
                     searchValue = 'WebName' + ':' + doubleQuotes + jQuery.trim(removeNonAlphaNumCharEndWildCard(elem[i].value)) + doubleQuotes + '~5';
                     searchValue = '#' + searchValue + '#';
                     searchValueQuery = 'Name' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;    
                           
                           } else if ($('input[name=searchkind]:checked').val() == 'Phonetic') {
                                 searchValue = 'WebPhoneticName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                                 searchValue = '#' + searchValue + '#';
                                 searchValueQuery = 'Phonetic Name' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;          
                                }
                                
                                
                            } else {
                                 searchValue = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                                 searchValue = '#' + searchValue + '#';
                                 searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                            }
                            if (searchValue != '') {
                                searchString = searchString + searchValue + andOrClause;
                                searchQuery = searchQuery  + searchValueQuery + andOrClause;
                            }
                        }
                    }
                    if (hasSpecialNames == 'Y') {
                        enhanceSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition)
                    } else {
                    document.getElementById("lq").value = searchString;
                    document.getElementById("searchQuery").value = searchQuery;
                    document.search_${searchResult.indexName}.method = "get";
                    document.search_${searchResult.indexName}.action = "search.do";
                    document.search_${searchResult.indexName}.searchType.value = "2";           
                    document.getElementById("searchable").value = searchfields; 
            if (document.getElementById('advancedSortOrder').value.indexOf("|") != -1) {
              document.getElementById("sortBy").value = document.getElementById('advancedSortOrder').value.split('|')[0]; 
              document.getElementById("desc").value = document.getElementById('advancedSortOrder').value.split('|')[1]; 
            } else {
              document.getElementById("sortBy").value = document.getElementById('advancedSortOrder').value; 
            }
            setCookie('adso', document.getElementById('advancedSortOrder').value, 0);
            document.search_${searchResult.indexName}.submit();
                    }  
                } catch (err) {
                    alert(err.message);
                }
            }   
        
        
        function enhanceSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition) {
            var doubleQuotes = '"'; 
            var value = $('#WebName').val().replace(/&/g,"%26");
            var url = "search.do?indexName=synonyms&templateName=default&lq=%23EKEY:%22" + value + "%22%7E5%23" ;
            enhancingValue = '(' + enhancingValue;
            $.getJSON(url, function(data){
             $.each(data.items, function(i,item){
                  enhancingValue = enhancingValue + ' OR ' + '' + 'NameSort' + ':' + doubleQuotes + item.VALUE.toLowerCase() + doubleQuotes;              
             });
            enhancingValue = enhancingValue + ')';
            if (jQuery.trim(searchString) !="") {
            searchString = enhancingValue + enhancingValueCondition + searchString;
        } else {
            searchString = enhancingValue;  
        }
        performEnhancedSearch(searchString, searchQuery)     
            });
        }
    
        function performEnhancedSearch(searchString, searchQuery) {
             document.getElementById("lq").value = searchString;
             document.getElementById("searchQuery").value = searchQuery;
             document.search_${searchResult.indexName}.method = "get";
             document.search_${searchResult.indexName}.action = "search.do";
             document.search_${searchResult.indexName}.searchType.value = "2";           
             document.getElementById("searchable").value = searchfields; 
        if (document.getElementById('advancedSortOrder').value.indexOf("|") != -1) {
              document.getElementById("sortBy").value = document.getElementById('advancedSortOrder').value.split('|')[0]; 
              document.getElementById("desc").value = document.getElementById('advancedSortOrder').value.split('|')[1]; 
            } else {
              document.getElementById("sortBy").value = document.getElementById('advancedSortOrder').value; 
            }
            setCookie('bso', document.getElementById('advancedSortOrder').value, 0);
            document.search_${searchResult.indexName}.submit();
            }
    
        function enhancePhoneticSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition) {
            var doubleQuotes = '"'; 
            var value = $('#WebName').val().replace(/&/g,"%26");
            var url = "search.do?indexName=synonyms&templateName=default&lq=%23EKEY:%22" + value + "%22%7E5%23" ;
            enhancingValue = '(' + enhancingValue;
            $.getJSON(url, function(data){
             $.each(data.items, function(i,item){
                  enhancingValue = enhancingValue + ' OR ' + '' + 'PhoneticNameSort' + ':' + doubleQuotes + item.VALUE.toLowerCase() + doubleQuotes;              
             });
            enhancingValue = enhancingValue + ')';
            if (jQuery.trim(searchString) !="") {
            searchString = enhancingValue + enhancingValueCondition + searchString;
        } else {
            searchString = enhancingValue;  
        }
        performEnhancedPhoneticSearch(searchString, searchQuery)     
            });
        }
    
        function performEnhancedPhoneticSearch(searchString, searchQuery) {
             document.getElementById("lq").value = searchString;
             document.getElementById("searchQuery").value = searchQuery;
             document.search_${searchResult.indexName}.method = "get";
         document.search_${searchResult.indexName}.action = "search.do";
         document.search_${searchResult.indexName}.searchType.value = "2";           
         document.getElementById("searchable").value = phoneticfields;
             document.getElementById("isPhoneticSearch").value = "1";  
        if (document.getElementById('advancedSortOrder').value.indexOf("|") != -1) {
              document.getElementById("sortBy").value = document.getElementById('advancedSortOrder').value.split('|')[0]; 
              document.getElementById("desc").value = document.getElementById('advancedSortOrder').value.split('|')[1]; 
            } else {
              document.getElementById("sortBy").value = document.getElementById('advancedSortOrder').value; 
            }
        setCookie('bso', document.getElementById('advancedSortOrder').value, 0);
        document.search_${searchResult.indexName}.submit();
            }
        
        function removeNonAlphaNumChar(input) {
              var re = new RegExp($("#regex").val(), "g");
              input = input.replace(re, "");
              input = "*" + input + "*";
              return input;
            }
            
            function removeNonAlphaNumCharRetainSpaces(input) {
          var re = new RegExp($("#regexwithspaces").val(), "g");
          input = input.replace(re, "");
          input = input.replace(/ /g, "* *");
              return input;
            }
            
            function removeNonAlphaNumCharNoWildCard(input) {
                  var re = new RegExp($("#regex").val(), "g");
                  input = input.replace(re, "");
                  return input;
            }
            
            function removeNonAlphaNumCharEndWildCard(input) {
                  var re = new RegExp($("#regex").val(), "g");
                  input = input.replace(re, "");
                  input = input + "*";
                  return input;
        }
        
        
    
//* Add to clear search results

function clearSearchResults()  
{   
  document.getElementById("q").value = ""; 
}

//*Start JQuery textbox/dropdown combo box:

(function( $ ) {
        $.widget( "ui.combobox", {
            _create: function() {
                var input,
                    self = this,
                    select = this.element.hide(),
                    selected = select.children( ":selected" ),
                    value = selected.val() ? selected.text() : "",
                    wrapper = this.wrapper = $( "<span>" )
                        .addClass( "ui-combobox" )
                        .insertAfter( select );

                input = $( "<input />" )
                    .appendTo( wrapper )
                    .val( value )
                    .addClass( "ui-state-default ui-combobox-input" )
                    .autocomplete({
                        delay: 0,
                        minLength: 0,
                        source: function( request, response ) {
                            var matcher = new RegExp( $.ui.autocomplete.escapeRegex(request.term), "i" );
                            response( select.children( "option" ).map(function() {
                                var text = $( this ).text();
                                if ( this.value && ( !request.term || matcher.test(text) ) )
                                    return {
                                        label: text.replace(
                                            new RegExp(
                                                "(?![^&;]+;)(?!<[^<>]*)(" +
                                                $.ui.autocomplete.escapeRegex(request.term) +
                                                ")(?![^<>]*>)(?![^&;]+;)", "gi"
                                            ), "<strong>$1</strong>" ),
                                        value: text,
                                        option: this
                                    };
                            }) );
                        },
                        select: function( event, ui ) {
                            ui.item.option.selected = true;
                            self._trigger( "selected", event, {
                                item: ui.item.option
                            });
                        },
                        change: function( event, ui ) {
                            if ( !ui.item ) {
                                var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( $(this).val() ) + "$", "i" ),
                                    valid = false;
                                select.children( "option" ).each(function() {
                                    if ( $( this ).text().match( matcher ) ) {
                                        this.selected = valid = true;
                                        return false;
                                    }
                                });
                                /*if ( !valid ) {
                                    // remove invalid value, as it didn't match anything
                                    $( this ).val( "" );
                                    select.val( "" );
                                    input.data( "autocomplete" ).term = "";
                                    return false;
                                }*/
                            }
                        }
                    })
                    .addClass( "ui-widget ui-widget-content ui-corner-left" );

                input.data( "autocomplete" )._renderItem = function( ul, item ) {
                    return $( "<li></li>" )
                        .data( "item.autocomplete", item )
                        .append( "<a>" + item.label + "</a>" )
                        .appendTo( ul );
                };

                $( "<a>" )
                    .attr( "tabIndex", -1 )
                    .attr( "title", "Show All Items" )
                    .appendTo( wrapper )
                    .button({
                        icons: {
                            primary: "ui-icon-triangle-1-s"
                        },
                        text: false
                    })
                    .removeClass( "ui-corner-all" )
                    .addClass( "ui-corner-right ui-combobox-toggle" )
                    .click(function() {
                        // close if already visible
                        if ( input.autocomplete( "widget" ).is( ":visible" ) ) {
                            input.autocomplete( "close" );
                            return;
                        }

                        // work around a bug (likely same cause as #5265)
                        $( this ).blur();

                        // pass empty string as value to search for, displaying all results
                        input.autocomplete( "search", "" );
                        input.focus();
                    });
            },

            destroy: function() {
                this.wrapper.remove();
                this.element.show();
                $.Widget.prototype.destroy.call( this );
            }
        });
    })( jQuery );

    $(function() {
        $( "#combobox" ).combobox();
        $( "#toggle" ).click(function() {
            $( "#combobox" ).toggle();
        });
    });

</script>
<form name="search_${searchResult.indexName}" id="search_${searchResult.indexName}">
    <input type="hidden" name="indexName" value="${searchResult.indexName}">
    <input type="hidden" name="templateName" value="${searchResult.templateName}">
    <input type="hidden" name="searchQuery" id="searchQuery">
    <input type="hidden" name="lq" id="lq">
    <input type="hidden" name="searchType" id="searchType" value="${Request.searchForm.searchType}">
    <input type="hidden" name="regex" id="regex" value="[^a-zA-Z0-9_]">
    <input type="hidden" name="regexwithspaces" id="regexwithspaces" value="[^a-zA-Z0-9\s_]">
    <input type="hidden" name="sortBy" id="sortBy" value="">
    <input type="hidden" name="desc" id="desc" value="">

    <label style="display:none;" for="totalResults">${total?if_exists}</label>


<#-- *Add searchable parameter -->
    <input type="hidden" name="searchable" id="searchable">
    <input type="hidden" name="isPhoneticSearch" id="isPhoneticSearch">
    <#--<input type="hidden" name="sortBy" id="sortBy" value="SortName,RecDateFiler">
    <input type="hidden" name="desc" id="desc" value="N">-->

        <#if Request.searchForm.searchType = "1">
            <div id="basicSearch" style="display:none">
        <#else>
            <div id="basicSearch" style="display:none">
        </#if>

<#-- *Add table for ROAM image -->
            <table  align="center" border="0">         
                <tr>
                    <td align="center">
                       <a href ="http://www.amcad.com/index.php?option=com_content&view=article&id=94&Itemid=50"><img src="templates/randolphsyn/Main/resource/ROAM.png" border="0"/></a> 
                    </td>
                </tr>
            </table> 

<#-- *Add table for links next to search button -->
           
<table border="0" align="center" width="100%" cellspacing="0" cellpadding="0">
    <tr>
        <td rowspan="2" width="33%" align="center"></TD>
        <td width="1%" align="center"></TD>
        <td rowspan="2" width="33%" align="left">
            &nbsp<a onClick="toggleDiv('advancedSearch');return false" href="#"><font size="1">Advanced Search</font></a>
            <br>
            &nbsp<a href="${request.getContextPath()}/search.do?indexName=documenttypes&templateName=ROAMHelp&q=&length=300#PHONETIC"><font size="1">What is Phonetic Search?</font></a>
        </td>
    </tr>
        <tr >
            <td align="right">
                     <input type="text" class="text" name="q" id="q" size="41" maxlength="2048" value="${searchResult.userInput?html}">
                 <#if Request.searchForm.searchType = "1">
                    <script language="javascript">  
                        document.getElementById('q').focus();
                    </script>
                 </#if>
            </td>
       </tr>
</table>

   <table border="0" align = "center">
    <tr>
        <td align="left">   
            <button type="button" class="search" onclick="javascript:postBasicSearch()">Search</button>
        </td>
        <td align="left"> 
<#-- *Add Phonetic Search button -->
                    <button type="button" class="search" onclick="javascript:postBasicPhoneticSearch()">Phonetic Search</button>  
                 </td>
        </tr> 
   </table>
</div>

        <#if Request.searchForm.searchType = "2">
            <div id="advancedSearch">
        <#else>
            <div id="advancedSearch">
        </#if>
           
<#-- *Increase table width from 40% to 50% and td width from 15% to 30% -->

<#-- **first table** -->                             

            <table align="center" border="0" width="40%" cellspacing="1" cellpadding="1">
<tr>
<td colspan="4">
<div class="module">
<div class="content">
<table align="center">




                <tr>

                    <td width="30%" align="right"><b><font class="label" color="green">${searchResult.datasetConfiguration.getColumn("WebName").displayName}&nbsp;:&nbsp;</font></b></td>
                    <td width="20%" colspan="2">
                        <input type="text" id="WebName" name="WebName" size="70" maxlength="2048">
                        <script language="javascript">                                          
                        if (getCookie('MainWebName') != null) {
                            document.getElementById("WebName").value = getCookie('MainWebName');
                        }
                        </script>
                    </td>                                           
                    <td width="5%" align="left">
                        <select name="WebName_select" id="WebName_select" >
                        <option value="AND" >AND</option>
                        <option value="OR" >OR</option>
                        </select>
                        <script language="javascript">                                          
                        if (getCookie('MainWebName_select') != null) {
                            document.getElementById("WebName_select").options[getCookie('MainWebName_select')].selected = true;
                        }
                        </script>                                           
                    </td>
                </tr>
                <tr>
                    <td width="30%" align="right">
                            <td width="20%" colspan="2" style=" text-align:center; ">
                    <form OnKeyPress="return disableKeyPress(event)">
                            <input type="radio" name="searchkind" value="Starts" checked="checked"/>Starts With
                            <input type="radio" name="searchkind" value="Contains"/>Contains
                            <input type="radio" name="searchkind" value="Exact" />Exact
                            <input type="radio" name="searchkind" value="Similar" />Similar
                            <input type="radio" name="searchkind" value="Phonetic" />Phonetic
                    
                    <script language="javascript">                                          
                         if (getCookie('searchkind') != null) {
                         var radioFilter = "'[value=" + getCookie('searchkind')+ "]'";
                         $('input:radio[name="searchkind"]').filter(radioFilter ).attr('checked', true);
                         } else {
                         var radioFilter = "'[value=none]'"; 
                         $('input:radio[name="searchkind"]').filter(radioFilter ).attr('checked', true);   
                         }
                    </script>
                    </form>
                     </td>
                    </td>
                </tr>
                <tr>
    <td></td>
    <td width="20%" colspan="2" style=" text-align:center; display:table-cell; font-size: 10pt;">
    <div id="buttons" class="radio-buttons">
        <input type="radio" id="enable" name="suggestion" value="enable"  >
        <label for="enable">Enable Search Suggestion</label>        
        <input type="radio" id="disable" name="suggestion" value="disable" checked="checked">
        <label for="disable">Disable Search Suggestion</label> 
    </div>        
<style>
#customizeForm input[type=radio] {
    margin: 5px 0px 40px 43px;
}



#buttons input[type=radio]:checked + label {
    --border: 2px solid #FFF!important;
    color: green;
    font-weight: bold;
}

</style>

    </td>
    </td>
</tr>                          
                        <tr>
                <td width="30%" align="right">
                <td width="20%" colspan="2" align="center">
                    <a href="${request.getContextPath()}/search.do?indexName=documenttypes&templateName=ROAMHelp&q=&length=300#TIPS" style="font-family:verdana,sans-serif; background:transparent; border-width:0; color:blue; text-decoration:underline; cursor:pointer; font-size:90%;">Click Here for Name Search Help</a>
                </td>
                </td>
                </tr>
                <tr>                                
                    <td width="30%" align="right" style="padding-bottom:15px;"><b><font class="label">${searchResult.datasetConfiguration.getColumn("RecDate").displayName}&nbsp;:&nbsp;</font></b></td>
                    <td width="18%" align="center"><b><font class="label">From&nbsp;:&nbsp;</font></b>
                        <input type="text" class="RecDateInput" id="frmRecDate" name="RecDate" title="${searchResult.datasetConfiguration.getColumn("RecDate").displayName}" size="10" maxlength="10">
                             <label id ="RecDateLabelFrom" for="frmRecDate">(mm/dd/yyyy)</label>
                                      <script language="javascript">
                                             $(function() {
                                                    var dates = $( "#frmRecDate, #toRecDate" ).datepicker({                 
                                                        changeYear: true, 
                                                        changeMonth: true,
                                                        changeMonth: true,
                                                        numberOfMonths: 1,
                                                        onSelect: function( selectedDate ) {
                                                            var option = this.id == "frmRecDate" ? "minDate" : "maxDate",
                                                                instance = $( this ).data( "datepicker" );
                                                                date = $.datepicker.parseDate(
                                                                    instance.settings.dateFormat ||
                                                                    $.datepicker._defaults.dateFormat,
                                                                    selectedDate, instance.settings );
                                                            dates.not( this ).datepicker( "option", option, date );
                                                        }
                                                    });
                                                });
                        if (getCookie('MainfrmRecDate') != null) {
                            document.getElementById("frmRecDate").value = getCookie('MainfrmRecDate');
                        }
                        </script>
                    </td>    
                    <td width="18%" align="center"><b><font class="label">To&nbsp;:&nbsp;</font></b>
                        <input type="text" class="RecDateInput" id="toRecDate" name="RecDate" title="${searchResult.datasetConfiguration.getColumn("RecDate").displayName}" size="10" maxlength="10">
                            <label id ="RecDateLabelTo" for="toRecDate">(mm/dd/yyyy)</label>
                        <script language="javascript">                                               
                        if (getCookie('MaintoRecDate') != null) {
                            document.getElementById("toRecDate").value = getCookie('MaintoRecDate');
                        }
                        </script>
                    </td>    
                    <td align="left">
                        <select name="RecDate_select" id="RecDate_select" >
                        <option value="AND" >AND</option>
                        <option value="OR" >OR</option>
                        <option value="NOT" >NOT</option>
                        </select>
                        <script language="javascript">                                          
                        if (getCookie('MainRecDate_select') != null) {
                            document.getElementById("RecDate_select").options[getCookie('MainRecDate_select')].selected = true;
                        }
                        </script>                                           
                    </td>
                                </tr>
                                <tr>
                    <td width="30%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("Book").displayName}&nbsp;:&nbsp;</font></b></td>
                    <td width="20%" colspan="2">
                        <input type="text" id="Book" name="Book" size="70" maxlength="2048">
                        <script language="javascript">                                          
                        if (getCookie('MainBook') != null) {
                            document.getElementById("Book").value = getCookie('MainBook');
                        }
                        </script>
                    </td>                                           
                    <td width="5%" align="left">
                        <select name="Book_select" id="Book_select" >
                        <option value="AND" >AND</option>
                        <option value="OR" >OR</option>
                        </select>
                        <script language="javascript">                                          
                        if (getCookie('MainBook_select') != null) {
                            document.getElementById("Book_select").options[getCookie('MainBook_select')].selected = true;
                        }
                        </script>                                           
                    </td>
                                </tr>
                                <tr>
                    <td width="30%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("Page").displayName}&nbsp;:&nbsp;</font></b></td>
                    <td width="20%" colspan="2">
                        <input type="text" id="Page"  name="Page" size="70" maxlength="2048">
                        <script language="javascript">                                          
                        if (getCookie('MainPage') != null) {
                            document.getElementById("Page").value = getCookie('MainPage');
                        }
                        </script>
                    </td>                                           
                    <td width="5%" align="left">
                        <select name="Page_select" id="Page_select" >
                        <option value="AND" >AND</option>
                        <option value="OR" >OR</option>
                        </select>
                        <script language="javascript">                                          
                        if (getCookie('MainPage_select') != null) {
                            document.getElementById("Page_select").options[getCookie('MainPage_select')].selected = true;
                        }
                        </script>                                           
                    </td>
                                </tr>
</table>
</div>
</div>
</td>
</tr>
                              </table>
<#-- **second table** -->                             

                              <table align="center" border="0" width="40%" cellspacing="1" cellpadding="1">
                                     <tr>
                                    <td colspan="4">
                                <div class="module">
                            <div class="header" id="header"><h1>Expand/Collapse Additional Search Fields</h1></div>
                            <div class="content">
                               <table align="center" style="padding-left:20px;">
                                
                                
                                
                                     <tr>
                    <td width="30%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("DocType").displayName}&nbsp;:&nbsp;</font></b></td>
                        <td width="20%">
                        <#function getDocument URL, indexName, query>
                            <#assign sc = new("net.javacoding.xsearch.api.SearchConnection")>
                            <#assign searchQueries = new("net.javacoding.xsearch.api.SearchQuery")>
                            ${sc.setIndex(indexName)}
                            ${sc.setURL(URL)}
                            ${sc.setLength(200)}
                            ${searchQueries.setAdvancedQuery(query)}
                            <#assign sr = sc.search(searchQueries)>
                            <#return sr.getDocList()>
                        </#function>
                        
                    <#--<#assign uri = pageStyleUtil.getSystemValue("url") + request.getContextPath()>-->
                        <#assign docdescs = getDocument("http://nv-rd1/randolph/", "doctype", "")>
                        <select name="DocTypeDesc" id="DocTypeDesc">
                                               <option value="">ALL</option>
                             <#if docdescs?has_content>
                                 <#foreach doc in docdescs>
                                      <option value="${doc.getString("DocTypeDesc")}">${doc.getString("DocTypeDesc")}</option>  
                                 </#foreach>
                                                     <script language="javascript">          
                                                       if (getCookie('MainDocTypeDesc') != null) {
                                                         $("option[value='" + getCookie('MainDocTypeDesc') + "']").attr('selected','selected');                                               
                                                       }
                                                     </script>     
                             </#if>
                        </select>
                    </td>
                         <td width="5%" align="left">
                            <select name="DocTypeDesc_select" id="DocTypeDesc_select" >
                            <option value="AND" >AND</option>
                            <option value="OR" >OR</option>
                            </select>
                            <script language="javascript">                                          
                            if (getCookie('MainDocTypeDesc_select') != null) {
                                document.getElementById("DocTypeDesc_select").options[getCookie('MainDocTypeDesc_select')].selected = true;
                            }
                            </script>                                           
                                 </td>


                             <#if Request.searchForm.searchType = "1">
                             <script language="javascript">  
                                   document.getElementById('q').focus();
                         </script>
                         </#if>
                      </td>                                     
                      </td>
                                    </tr>
                                
                                      <tr>
                                        <td width="15%" align="right"><b><font class="label">Instrument&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="Instrument"  name="Instrument" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainInstrument') != null) {
                                                document.getElementById("Instrument").value = getCookie('MainInstrument');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="Instrument_select" id="Instrument_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainInstrument_select') != null) {
                                                document.getElementById("Instrument_select").options[getCookie('MainInstrument_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("LegacyNumber").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="LegacyNumber"  name="LegacyNumber" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainLegacyNumber') != null) {
                                                document.getElementById("LegacyNumber").value = getCookie('MainLegacyNumber');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="LegacyNumber_select" id="LegacyNumber_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainLegacyNumber_select') != null) {
                                                document.getElementById("LegacyNumber_select").options[getCookie('MainLegacyNumber_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("Other").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="Other"  name="Other" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainOther') != null) {
                                                document.getElementById("Other").value = getCookie('MainOther');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="Other_select" id="Other_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainOther_select') != null) {
                                                document.getElementById("Other_select").options[getCookie('MainOther_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr> 

                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("BlockNum").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="BlockNum"  name="BlockNum" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainBlockNum') != null) {
                                                document.getElementById("BlockNum").value = getCookie('MainBlockNum');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="BlockNum_select" id="BlockNum_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainBlockNum_select') != null) {
                                                document.getElementById("BlockNum_select").options[getCookie('MainBlockNum_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>

                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("LotNum").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="LotNum"  name="LotNum" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainLotNum') != null) {
                                                document.getElementById("LotNum").value = getCookie('MainLotNum');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="LotNum_select" id="LotNum_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainLotNum_select') != null) {
                                                document.getElementById("LotNum_select").options[getCookie('MainLotNum_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>

                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("SectionNum").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="SectionNum"  name="SectionNum" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainSectionNum') != null) {
                                                document.getElementById("SectionNum").value = getCookie('MainSectionNum');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="SectionNum_select" id="SectionNum_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainSectionNum_select') != null) {
                                                document.getElementById("SectionNum_select").options[getCookie('MainSectionNum_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>
                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("Township").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="Township"  name="Township" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainTownship') != null) {
                                                document.getElementById("Township").value = getCookie('MainTownship');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="Township_select" id="Township_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainTownship_select') != null) {
                                                document.getElementById("Township_select").options[getCookie('MainTownship_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>

                            <tr>
                                <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("RangeNum").displayName}&nbsp;:&nbsp;</font></b></td>
                                <td width="20%">
                                <input type="text" id="RangeNum"  name="RangeNum" size="70" maxlength="2048">
                                <script language="javascript">                                          
                                if (getCookie('MainRangeNum') != null) {
                                    document.getElementById("RangeNum").value = getCookie('MainRangeNum');
                                }
                                </script>
                                </td>                                           
                                <td width="5%" align="left">
                                <select name="RangeNum_select" id="RangeNum_select" >
                                <option value="AND" >AND</option>
                                <option value="OR" >OR</option>
                                </select>
                                <script language="javascript">                                          
                                if (getCookie('MainRangeNum_select') != null) {
                                    document.getElementById("RangeNum_select").options[getCookie('MainRangeNum_select')].selected = true;
                                }
                                </script>                                           
                                </td>
                            </tr>
                                    <tr>
                                        <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("Subdivision").displayName}&nbsp;:&nbsp;</font></b></td>
                                        <td width="20%">
                                            <input type="text" id="Subdivision"  name="Subdivision" size="70" maxlength="2048">
                                            <script language="javascript">                                          
                                            if (getCookie('MainSubdivision') != null) {
                                                document.getElementById("Subdivision").value = getCookie('MainSubdivision');
                                            }
                                            </script>
                                        </td>                                           
                                        <td width="5%" align="left">
                                            <select name="Subdivision_select" id="Subdivision_select" >
                                            <option value="AND" >AND</option>
                                            <option value="OR" >OR</option>
                                            </select>
                                            <script language="javascript">                                          
                                            if (getCookie('MainSubdivision_select') != null) {
                                                document.getElementById("Subdivision_select").options[getCookie('MainSubdivision_select')].selected = true;
                                            }
                                            </script>                                           
                                        </td>
                                    </tr>

                            <tr>
                                <td width="15%" align="right"><b><font class="label">${searchResult.datasetConfiguration.getColumn("Parcel").displayName}&nbsp;:&nbsp;</font></b></td>
                                <td width="20%">
                                <input type="text" id="Parcel"  name="Parcel" size="70" maxlength="2048">
                                <script language="javascript">                                          
                                if (getCookie('MainParcel') != null) {
                                    document.getElementById("Parcel").value = getCookie('MainParcel');
                                }
                                </script>
                                </td>                                           
                                <td width="5%" align="left">
                                <select style="display:none" name="Parcel_select" id="Parcel_select" >
                                <option value="AND" >AND</option>
                                <option value="OR" >OR</option>
                                </select>
                                <script language="javascript">                                          
                                if (getCookie('MainParcel_select') != null) {
                                    document.getElementById("Parcel_select").options[getCookie('MainParcel_select')].selected = true;
                                }
                                </script>                                           
                                </td>
                                            </tr>
                                </table>
                               </div>
                        </div>
                                    </td>
                                </tr>
            </table>
         
<table align="center" border="0" width="40%" cellspacing="1" cellpadding="1">
<tr>
  <td width="15%" align="right"><b><font class="label">Sort By&nbsp;:&nbsp;</font></b></td>
  <td width="20%" colspan="2">
      <select name="advancedSortOrder" id="advancedSortOrder" class="sortBy">
        <option value="Instrument|Y">Instrument : High to Low</option>
        <option value="Instrument|N">Instrument : Low to High</option>
        <option value="SortName|N">Name : A to Z</option>
        <option value="SortName|Y">Name : Z to A</option>
        <option value="RecDateFilter|Y">Date : Max to Min</option>
        <option value="RecDateFilter|N">Date : Min to Max</option>
      </select>
    <script language="javascript">                                          
        if (getCookie('adso') != null) {
            $('#advancedSortOrder').val(getCookie('adso').toString());
        }  
    </script>  
   </td>
</tr>
    <tr valign="top">   
        <td width="50%">&nbsp;</td>
        <td><button type="button" class="search" onclick="javascript:postAdvancedSearch();">Search</button><br></td>
        <td width="40%" align="center"><input type="button" onClick="clearFormElements()" value="Clear Search Fields" style="font-family:verdana,sans-serif; background:transparent; border-width:0; color:blue; text-decoration:underline; cursor:pointer; font-size:65%;"><br>
            <a href="${request.getContextPath()}/search.do?indexName=documenttypes&templateName=ROAMHelp&q=&length=300#PHONETIC" style="font-family:verdana,sans-serif; background:transparent; border-width:0; color:blue; text-decoration:underline; cursor:pointer; font-size:65%;">What is Phonetic Search?</a>
            <br/><a href="${request.getContextPath()}/search.do?indexName=documenttypes&templateName=ROAMHelp&q=&length=300#TIPS" style="font-family:verdana,sans-serif; background:transparent; border-width:0; color:blue; text-decoration:underline; cursor:pointer; font-size:65%;">Search Help</a>
            <#--<a onClick="toggleDiv('basicSearch');return false" href="#"><font size="1">Basic Search</font></a>-->
        </td>                                                                               
    </tr>
</table>
        
</div>
</div>
</div> 

<#-- *Hide clear search results button 
<table width="100%"  border="0" cellpadding="0" cellspacing="0">
  <tr>
  <td>
<table border=0 cellpadding=0 cellspacing=0 ><tr>
<td>&nbsp;</td></tr>
</table></td><td><table align="right" border="0" cellpadding="0" cellspacing="0" >
      <tr><td align = "right"><a onClick="clearSearchResults();postBasicSearch();" href="#"><font size ="2">Clear Search Results</font></a></td>
 </table></td>
  </tr>
</table>
-->

</form>
<script type="text/javascript">
$(document).ready(function(){
    $.collapsible(".header", "group1"); 
    $("div.header").next().hide();
});
</script>
<#include "searchBox_extra.stl">
