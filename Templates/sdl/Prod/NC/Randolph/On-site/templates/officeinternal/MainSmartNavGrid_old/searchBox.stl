<style>
    .RecDateInput{
        color:#777777;
    }
</style>

<script type="text/javascript">

// *Set values for searchable fields
var searchfields = "WebName,ExactName,NameSort,Instrument,RecDate,PartyRole,IndexType,DocType,Book,Page,LotNum,Unit,SectionNum,Subdivision,Township,Other,DesigStatus,GPIN,ProjectNum,RdNum,Desc2,Desc3,Phase,Acreage,Building";
var phoneticfields = "WebPhoneticName,ExactName,PhoneticNameSort,Instrument,RecDate,PartyRole,IndexType,DocType,Book,Page,LotNum,Unit,SectionNum,Subdivision,Township,Other,DesigStatus,GPIN,ProjectNum,RdNum,Desc2,Desc3,Phase,Acreage,Building";

    function unique(arrayName) {
            var newArray=new Array();
            label:for(var i=0; i<arrayName.length;i++ )
            {  
                for(var j=0; j<newArray.length;j++ ) {
                    if(newArray[j].name == arrayName[i].name) 
                     continue label;
                }
                setCookie('Main' + arrayName[i].name, jQuery.trim(arrayName[i].value), 0);
                if (arrayName[i].type == 'text' && jQuery.trim(arrayName[i].value).length != 0) {
                    newArray[newArray.length] = arrayName[i];
                }
            }
                setCookie('MainfrmRecDate', document.getElementById('frmRecDate').value, 0);
                setCookie('MaintoRecDate',  document.getElementById('toRecDate').value, 0);
            return newArray;
        }   
        function postAdvancedSearch() {
            try {
                if ($('input[name=searchkind]:checked').val() == null || $('input[name=searchkind]:checked').val() == "") {
                $('input[name=searchkind]:nth(0)').attr("checked","checked");
             } 
                if (!doDateCheck('frmRecDate','toRecDate'))return;
                document.getElementById("q").value = '';
                var inputElemenets =  $('input[type="text"]');
                var elem = unique(inputElemenets);
                var searchString = '';
                var searchQuery = '';
                var andOrClause ='';
                var doubleQuotes = '"';
                var counter = 0;
                var textcounter = 0;
                var searchValue = '';
                var searchValueQuery = '';
                var hasSpecialNames = 'N';
                var enhancingValue = '';
                for(var i = 0; i < elem.length; i++) {
                    if (document.getElementById(elem[i].name + '_select') != null) {
                        counter++;  
                    }                   
                }
                setCookie('searchkind', $('input[name=searchkind]:checked').val(), 0);
                for(var i = 0; i < elem.length; i++) {
                    if (document.getElementById(elem[i].name + '_select') != null) {
                        setCookie('Main' + elem[i].name + '_select', document.getElementById(elem[i].name + '_select').selectedIndex, 0);
                        textcounter++
                        if (textcounter == counter) {
                            andOrClause = '';
                        } else {
                            andOrClause = ' ' + document.getElementById(elem[i].name + '_select').value + '  ';
                        }
                        if (elem[i].name == 'RecDate') {
                            searchValue = getDateQuery(elem[i].name);
                            searchValueQuery = getDateSearchQuery(elem[i].name);
                        } else if (elem[i].name == 'NameSort') {
                            searchValue = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                            searchValue = '#' + searchValue + '#';
                            searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                        } else if (elem[i].name == 'WebName') {                        
                            if ($('input[name=searchkind]:checked').val() == 'Exact') {
                                 searchValue = 'ExactName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                                 searchValue = '#' + searchValue + '#';
                                 searchValueQuery = 'ExactName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                            } else if ($('input[name=searchkind]:checked').val() == 'Similar') {
                                 enhancingValue = 'NameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value).toLowerCase() + doubleQuotes;
                                 if (textcounter == counter) {
                                     enhancingValueCondition = '';
                                 } else {
                                     enhancingValueCondition = ' ' + document.getElementById(elem[i].name + '_select').value + '  ';
                                 }
                                 searchValueQuery = 'NameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;  
                                 hasSpecialNames = 'Y';  
                                 searchValue = '';                                 
                            } else if ($('input[name=searchkind]:checked').val() == 'Like') {
                             searchValue = '#' + elem[i].name + ':' + doubleQuotes + jQuery.trim(removeNonAlphaNumChar(elem[i].value)) + doubleQuotes + '#' + ' OR ';
                             searchValue = searchValue + '#' + elem[i].name + ':' + doubleQuotes + "*" + jQuery.trim(removeNonAlphaNumCharRetainSpaces(elem[i].value)) + "*" + doubleQuotes + '#';
                             searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;    
                            }
                        } else {
                             searchValue = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                             searchValue = '#' + searchValue + '#';
                             searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                        }
                        if (searchValue != '') {
                            searchString = searchString + searchValue + andOrClause;
                            searchQuery = searchQuery  + searchValueQuery + andOrClause;
                        }
                    }
                }
                if (hasSpecialNames == 'Y') {
                    enhanceSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition)
                } else {
                document.getElementById("lq").value = searchString;
                document.getElementById("searchQuery").value = searchQuery;
                document.search_${searchResult.indexName}.method = "get";
                document.search_${searchResult.indexName}.action = "search.do";
                document.search_${searchResult.indexName}.searchType.value = "2";           
                document.getElementById("searchable").value = searchfields; 
                document.search_${searchResult.indexName}.submit();
                }  
            } catch (err) {
                alert(err.message);
            }
        }   
        
        
        function enhanceSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition) {
            var doubleQuotes = '"'; 
            var value = $('#WebName').val().replace(/&/g,"%26");
            var url = "search.do?indexName=synonyms&templateName=default&lq=%23EKEY:%22" + value + "%22%7E5%23" ;
            enhancingValue = '(' + enhancingValue;
            $.getJSON(url, function(data){
             $.each(data.items, function(i,item){
                  enhancingValue = enhancingValue + ' OR ' + '' + 'NameSort' + ':' + doubleQuotes + item.VALUE.toLowerCase() + doubleQuotes;              
             });
            enhancingValue = enhancingValue + ')';
            if (jQuery.trim(searchString) !="") {
            searchString = enhancingValue + enhancingValueCondition + searchString;
        } else {
            searchString = enhancingValue;  
        }
        performEnhancedSearch(searchString, searchQuery)     
            });
        }
    
        function performEnhancedSearch(searchString, searchQuery) {
             document.getElementById("lq").value = searchString;
             document.getElementById("searchQuery").value = searchQuery;
             document.search_${searchResult.indexName}.method = "get";
             document.search_${searchResult.indexName}.action = "search.do";
             document.search_${searchResult.indexName}.searchType.value = "2";           
             document.getElementById("searchable").value = searchfields; 
             document.search_${searchResult.indexName}.submit();
        }
    
        function enhancePhoneticSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition) {
            var doubleQuotes = '"'; 
            var value = $('#WebName').val().replace(/&/g,"%26");
            var url = "search.do?indexName=synonyms&templateName=default&lq=%23EKEY:%22" + value + "%22%7E5%23" ;
            enhancingValue = '(' + enhancingValue;
            $.getJSON(url, function(data){
             $.each(data.items, function(i,item){
                  enhancingValue = enhancingValue + ' OR ' + '' + 'PhoneticNameSort' + ':' + doubleQuotes + item.VALUE.toLowerCase() + doubleQuotes;              
             });
            enhancingValue = enhancingValue + ')';
            if (jQuery.trim(searchString) !="") {
            searchString = enhancingValue + enhancingValueCondition + searchString;
        } else {
            searchString = enhancingValue;  
        }
        performEnhancedPhoneticSearch(searchString, searchQuery)     
            });
        }
    
        function performEnhancedPhoneticSearch(searchString, searchQuery) {
             document.getElementById("lq").value = searchString;
             document.getElementById("searchQuery").value = searchQuery;
             document.search_${searchResult.indexName}.method = "get";
         document.search_${searchResult.indexName}.action = "search.do";
         document.search_${searchResult.indexName}.searchType.value = "2";           
         document.getElementById("searchable").value = phoneticfields;
             document.getElementById("isPhoneticSearch").value = "1";  
         document.search_${searchResult.indexName}.submit();
        }
        
        function removeNonAlphaNumChar(input) {
              var re = new RegExp($("#regex").val(), "g");
              input = input.replace(re, "");
              input = "*" + input + "*";
              return input;
            }
            
            function removeNonAlphaNumCharRetainSpaces(input) {
          var re = new RegExp($("#regexwithspaces").val(), "g");
          input = input.replace(re, "");
          input = input.replace(/ /g, "* *");
              return input;
            }
            
            function removeNonAlphaNumCharNoWildCard(input) {
                  var re = new RegExp($("#regex").val(), "g");
                  input = input.replace(re, "");
                  return input;
            }
            
            function removeNonAlphaNumCharEndWildCard(input) {
                  var re = new RegExp($("#regex").val(), "g");
                  input = input.replace(re, "");
                  input = input + "*";
                  return input;
        }
        
        function postBasicSearch() {
            try {   
                setCookie('Main' + document.getElementById("q").name, document.getElementById("q").value, 0);
                document.getElementById("lq").value = '';
                document.search_${searchResult.indexName}.method = "get";
                document.getElementById('searchQuery').value = document.getElementById('q').value
                document.search_${searchResult.indexName}.action = "search.do";
                document.search_${searchResult.indexName}.searchType.value = "1";
                document.getElementById("searchable").value = searchfields; 
                document.search_${searchResult.indexName}.submit();
            } catch (err) {
                alert(err.message);
            }
        }
    
    // *Add function for basic Phonetic Search 
    function postBasicPhoneticSearch() {
        try {   
            document.getElementById("lq").value = '';
            document.search_${searchResult.indexName}.method = "get";
            document.getElementById('searchQuery').value = document.getElementById('q').value
            document.search_${searchResult.indexName}.action = "search.do";
            document.search_${searchResult.indexName}.searchType.value = "1";
            document.getElementById("searchable").value = phoneticfields;
            document.getElementById("isPhoneticSearch").value = "1";
            document.search_${searchResult.indexName}.submit();
        } catch (err) {
            alert(err.message);
        }
    } 
    
    // *Add function for advanced Phonetic Search 
        function postAdvancedPhoneticSearch() {
            try {
            if ($('input[name=searchkind]:checked').val() == null || $('input[name=searchkind]:checked').val() == "") {
            $('input[name=searchkind]:nth(0)').attr("checked","checked");
             } 
            if (!doDateCheck('frmRecDate','toRecDate'))return;
            document.getElementById("q").value = '';
            var inputElemenets =  $('input[type="text"]');
            var elem = unique(inputElemenets);
            var searchString = '';
            var searchQuery = '';
            var andOrClause ='';
            var doubleQuotes = '"';
            var counter = 0;
            var textcounter = 0;
            var searchValue = '';
            var searchValueQuery = '';
            var hasSpecialNames = 'N';
            var enhancingValue = '';
    
            for(var i = 0; i < elem.length; i++) {
                if (document.getElementById(elem[i].name + '_select') != null) {
                    counter++;  
                }                   
            }
            setCookie('searchkind', $('input[name=searchkind]:checked').val(), 0);
            for(var i = 0; i < elem.length; i++) {
                if (document.getElementById(elem[i].name + '_select') != null) {
                    setCookie('Main' + elem[i].name + '_select', document.getElementById(elem[i].name + '_select').selectedIndex, 0);
                    textcounter++
                    if (textcounter == counter) {
                        andOrClause = '';
                    } else {
                        andOrClause = ' ' + document.getElementById(elem[i].name + '_select').value + '  ';
                    }
                    
                    if (elem[i].name == 'RecDate') {
                        searchValue = getDateQuery(elem[i].name);
                        searchValueQuery = getDateSearchQuery(elem[i].name);
                    } else if (elem[i].name == 'WebName') {
                searchValue = 'WebPhoneticName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                searchValue = '#' + searchValue + '#';
                searchValueQuery = 'WebPhoneticName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
            } else if (elem[i].name == 'NameSort') {
                searchValue = 'PhoneticNameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                searchValue = '#' + searchValue + '#';
                searchValueQuery = 'PhoneticNameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                    } else if (elem[i].name == 'WebName') {        
                            if ($('input[name=searchkind]:checked').val() == 'Exact') {
                                 searchValue = 'WebPhoneticName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                                 searchValue = '#' + searchValue + '#';
                                 searchValueQuery = 'WebPhoneticName' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                            } else if ($('input[name=searchkind]:checked').val() == 'Similar') {
                                 enhancingValue = 'PhoneticNameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value).toLowerCase() + doubleQuotes;
                                 searchValueQuery = 'PhoneticNameSort' + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;  
                                 if (textcounter == counter) {
                                     enhancingValueCondition = '';
                                 } else {
                                     enhancingValueCondition = ' ' + document.getElementById(elem[i].name + '_select').value + '  ';
                                 }
                                 hasSpecialNames = 'Y';  
                                 searchValue = '';
                                 andOrClause = '';
                            } else if ($('input[name=searchkind]:checked').val() == 'Like') {
                             searchValue = '#' + elem[i].name + ':' + doubleQuotes + jQuery.trim(removeNonAlphaNumChar(elem[i].value)) + doubleQuotes + '#' + ' OR ';
                 searchValue = searchValue + '#' + elem[i].name + ':' + doubleQuotes + "*" + jQuery.trim(removeNonAlphaNumCharRetainSpaces(elem[i].value)) + "*" + doubleQuotes + '#';
                         searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                            }
               } else {
                    searchValue = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes + '~5';
                        searchValue = '#' + searchValue + '#';
                        searchValueQuery = elem[i].name + ':' + doubleQuotes + jQuery.trim(elem[i].value) + doubleQuotes;
                }
    
    
                    searchString = searchString + searchValue + andOrClause;
                    searchQuery = searchQuery  + searchValueQuery + andOrClause;
                }
            }
    
                if (hasSpecialNames == 'Y') {
                    enhancePhoneticSearchString(searchString, searchQuery, enhancingValue, enhancingValueCondition )
                } else {
                document.getElementById("lq").value = searchString;
                document.getElementById("searchQuery").value = searchQuery;
                document.search_${searchResult.indexName}.method = "get";
                document.search_${searchResult.indexName}.action = "search.do";
                document.search_${searchResult.indexName}.searchType.value = "2";           
                document.getElementById("searchable").value = phoneticfields;
                        document.getElementById("isPhoneticSearch").value = "1";  
                document.search_${searchResult.indexName}.submit();
                }  
            } catch (err) {
                alert(err.message);
            }
        } 
    
//* Add to clear search results

function clearSearchResults()  
{   
  document.getElementById("q").value = ""; 
}


//*Add watermark to Rec Date with IE fix
 $(document).ready(function() {
   
   $('.RecDateInput').attr("placeholder", "mm/dd/yyyy").datepicker();
   
   if(!Modernizr.input.placeholder){
   
   $('.RecDateInput').each(
   function(){
    if($(this).val()=="" && $(this).attr("placeholder")!=""){
       $(this).val($(this).attr("placeholder"));
       $(this).focus(function(){
    if($(this).val()==$(this).attr("placeholder")) $(this).val("");
    });
   $(this).blur(function(){
    if($(this).val()=="") $(this).val($(this).attr("placeholder"));
     });
       }
   });
   
   }
   
});     

function checkWaterMark(){

    if($('.RecDateInput').val() == "mm/dd/yyyy"){
       $('.RecDateInput').val("");
       }
}




</script>


<form name="search_${searchResult.indexName}" id="search_${searchResult.indexName}">
    <input type="hidden" name="indexName" value="${searchResult.indexName}">
    <input type="hidden" name="templateName" value="${searchResult.templateName}">
    <input type="hidden" name="searchQuery" id="searchQuery">
    <input type="hidden" name="lq" id="lq">
    <input type="hidden" name="searchType" id="searchType" value="${Request.searchForm.searchType}">
    <input type="hidden" name="regex" id="regex" value="[^a-zA-Z0-9_]">
    <input type="hidden" name="regexwithspaces" id="regexwithspaces" value="[^a-zA-Z0-9\s_]">

    
<#-- *Add searchable parameter -->
    <input type="hidden" name="searchable" id="searchable">
    <input type="hidden" name="isPhoneticSearch" id="isPhoneticSearch">
   <input type="hidden" name="sortBy" id="sortBy" value="SortName,RecDateFiler">
    <input type="hidden" name="desc" id="desc" value="N">

        <#if Request.searchForm.searchType = "1">
            <div id="basicSearch" style="display:none">
        <#else>
            <div id="basicSearch" style="display:none">
        </#if>


 
</form>

<script type="text/javascript">
$(document).ready(function(){
    $.collapsible(".header", "group1"); 
    $("input").keypress(function (e) {
        var k = e.keyCode || e.which;
        if (k == 13) {
            postAdvancedSearch();
        }
    });
});
</script>
