<#assign documentCounter = 0>

<#if searchResult.docs?has_content>
    <#foreach doc in searchResult.docs> 
    <#foreach Instrument in doc.getValues("Instrument")>
       <#assign refCounter = 1>    
       <#break>
    </#foreach>
    </#foreach>
</#if>

<#if searchResult.docs?has_content>

<#if (refCounter > 0)>


<font size="3"><b>Referenced By</b></font>
<table id="refby" class="tablesorter">
     <thead>
        <tr>
          <th>Referenced by #</th>
          <th>${searchResult.datasetConfiguration.getColumn("DocRefBookType2").displayName}</th>
          <th>${searchResult.datasetConfiguration.getColumn("DocRefBook2").displayName}</th>
          <th>${searchResult.datasetConfiguration.getColumn("DocRefPage2").displayName}</th>
        </tr>
     </thead>
     <tbody>

<#foreach doc in searchResult.docs>
         <#assign RefInstrument2 = doc.getValues("RefInstrument2") Instrument = doc.getValues("Instrument") DocRefBookType2 = doc.getValues("DocRefBookType2") DocRefBook2 = doc.getValues("DocRefBook2") DocRefPage2 = doc.getValues("DocRefPage2")
                  DocRefLegacy2 = doc.getValues("DocRefLegacy2") loopCounter = 0>
                  
         <#foreach Instrument in doc.getValues("Instrument")>
       <tr>
          <td><font size="2px" face="verdana,sans-serif"><a href="${request.getContextPath()}/search.do?indexName=randolphdetails&templateName=default&lq=${pageStyleUtil.encodeURL("Instrument:\"")}${Instrument}${pageStyleUtil.encodeURL("\"")}&OI=${OI}&IS=${IS}&IC=${IC}">${Instrument?replace('|', '&nbsp;')}</a></font></td>
          <td>${DocRefBookType2[loopCounter]?replace('|', '&nbsp;')}</td>
          <td>${DocRefBook2[loopCounter]?replace('|', '&nbsp;')}</td> 
          <td>${DocRefPage2[loopCounter]?replace('|', '&nbsp;')}</td>

          <#assign loopCounter = loopCounter + 1>
       </tr>
         </#foreach>
 </#foreach>
</#if>

</#if>



    </tbody>
</table>


<script type="text/javascript">
$(document).ready(function() {

    oTable = $('#refby').dataTable({
        "bJQueryUI": true,
        "bPaginate": false,
        "bLengthChange": false,
        "bFilter": false,
        "bSort": true,
        "bInfo": false,
        "bAutoWidth": false,
        "aaSorting": []
    });
    

} );
</script>
