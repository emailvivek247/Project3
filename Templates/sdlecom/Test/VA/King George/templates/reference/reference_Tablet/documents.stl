<#assign documentCounter = 0>

<#if searchResult.docs?has_content>
    <#foreach doc in searchResult.docs> 
    <#foreach Instrument in doc.getValues("Instrument")>
       <#assign refCounter = 1>    
       <#break>
    </#foreach>
    </#foreach>
</#if>

<#if searchResult.docs?has_content>

<#if (refCounter > 0)>


<b><font size="3px" color="#000000" > Referenced By</font></b>
<table id="refby" class="tablesorter">
           <thead>
                <tr>
<#--      <th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("Instrument").displayName}</th> -->
          <th class="ui-state-default">Referenced by #</th>
          <th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("DocRefBookType2").displayName}</th>
          <th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("DocRefBook2").displayName}</th>
          <th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("DocRefPage2").displayName}</th>
          <#-- <th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("DocRefLegacy2").displayName}</th> -->
        </tr>
            </thead>
         <tbody>

<#foreach doc in searchResult.docs>
         <#assign Instrument = doc.getValues("RefInstrument2")>
         <#assign RefInstrument2 = doc.getValues("Instrument")>
         <#assign DocRefBookType2 = doc.getValues("DocRefBookType2")>
         <#assign DocRefBook2 = doc.getValues("DocRefBook2")>
         <#assign DocRefPage2 = doc.getValues("DocRefPage2")>
         <#assign DocRefLegacy2 = doc.getValues("DocRefLegacy2")>
         <#assign loopCounter = 0>
                  
         <#foreach Instrument in doc.getValues("Instrument")>

               <tr>
<#--         <td>${Instrument}</td> -->
          <td><font size="2px" >
              <a href="${request.getContextPath()}/search.do?indexName=details&templateName=Details_SNTablet&lq=${pageStyleUtil.encodeURL("Instrument:\"")}${RefInstrument2[loopCounter]}${pageStyleUtil.encodeURL("\"")}&OI=${OI}&IS=${IS}&IC=${IC}">${RefInstrument2[loopCounter]?replace('|', '&nbsp;')}</a>
          </font></td>

          <td>${DocRefBookType2[loopCounter]?replace('|', '&nbsp;')}</td> 
          <td>${DocRefBook2[loopCounter]?replace('|', '&nbsp;')}</td> 
          <td>${DocRefPage2[loopCounter]?replace('|', '&nbsp;')}</td> 
    <#--  <td>${DocRefLegacy2[loopCounter]?replace('|', '&nbsp;')}</td> -->

          <#assign loopCounter = loopCounter + 1>
               </tr>
         </#foreach>
 </#foreach>
</#if>

</#if>



</tbody>
      </table>

<script type="text/javascript">
$(document).ready(function() {

    oTable = $('#searchResult').dataTable({
        "bJQueryUI": true,
        "bPaginate": false,
        "bLengthChange": false,
        "bFilter": false,
        "bSort": true,
        "bInfo": false,
        "bAutoWidth": false,
        "aaSorting": []
    });
    oTable = $('#refby').dataTable({
        "bJQueryUI": true,
        "bPaginate": false,
        "bLengthChange": false,
        "bFilter": false,
        "bSort": true,
        "bInfo": false,
        "bAutoWidth": false,
        "aaSorting": []
    });
    

} );
</script>