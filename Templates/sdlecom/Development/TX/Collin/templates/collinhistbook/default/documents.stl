<#if searchResult.docs?has_content>
<table id="searchResult" class="tablesorter">
 <thead><tr>
<th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("Book").displayName}</th>
<th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("Page").displayName}</th>
<th class="ui-state-default">${searchResult.datasetConfiguration.getColumn("Image").displayName}</th>
<#if pageStyleUtil.isUserInRoleGroup('PER_PAGE_ROLE', request) || pageStyleUtil.isUserInRoleGroup('UNOFFICIAL_ROLE', request)>   
<th class="ui-state-default" style="text-align:center;">Add to Cart</th>
</#if> 
  
  
  
 </tr></thead>
 <tbody>
<#assign ResultId =0>
 <#foreach doc in searchResult.docs>
  <#include "document.stl">
 </#foreach>
<#else>
 <#include "noResults.stl"> 
</#if>
 </tbody>
</table>


<script type="text/javascript">
$(document).ready(function() {

    oTable = $('#searchResult').dataTable({
            "bJQueryUI": true,
            "bPaginate": false,
            "bLengthChange": false,
            "bFilter": false,
            "bSort": true,
            "bInfo": false,
            "bAutoWidth": false,
            "aaSorting": []
        });
        
$(".cartLink").click(function() {
     	var dataString = 'indexName=histbookimages&lq=ID:' + $(this).attr("title");
     	$.ajax({
 	      type: "POST",
 	      url: "${request.getContextPath()}/search.do",
 	      data: dataString,      
 	      success: function(data) {
 	      	$.each(data, function(i,item){	    		    
 	    		 if (item.code == "EXISTS") {
 	    		 	var txt = item.description + "You can view your purchase using the below link, <br/> <a target='_blank' href='viewPayAsUGoPaymentDetails.admin?webTxId=" + item.moduleName + "'>View Purchase</a>";		
 					$.prompt(txt);
 	    		 } else if (item.code == "SUCCESS") {
 	    		 	if (item.count == 0) {
 	    				$("span#shoppingCartItems").text('  Shopping cart is Empty');
 	    				$.prompt(item.description);
 	    			} else {
 	    				$("span#shoppingCartItems").text('  ' + item.count + ' Item(s) in the Shopping Cart');
 	    				$.prompt(item.description);
 	    			}
 	    		 } else {
 	    			$.prompt(item.description); 
 	    		 }
 	          });     
 	      }
 	    });
     return false;
 	});
} );
</script>