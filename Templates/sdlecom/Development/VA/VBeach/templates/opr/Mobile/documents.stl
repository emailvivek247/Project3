<#if (searchResult.docs?has_content && searchResult.docs.size() > 0) >
<#assign ResultId =0>
 <#foreach doc in searchResult.docs>
     <p class="result">
     <br/><b>Instrument</b>:
                  <a href="${request.getContextPath()}/search.do?indexName=details&templateName=Details_SNMobile&lq=${pageStyleUtil.encodeURL("Instrument:\"" + doc.get("Instrument") + "\"")}"> ${searchResult.highlight(doc, "Instrument")}</a> 
          <br/><b>Recorded Date</b>:
                     <#if doc.get("RecDateDisplay")?has_content>
                         ${pageStyleUtil.format(doc.get("RecDateDisplay"), "yyyy-MM-dd HH:mm:ss", "MM/dd/yyyy HH:mm:ss a")}         
                     </#if>
      <br/><b>${searchResult.datasetConfiguration.getColumn("Consideration").displayName}</b>:${searchResult.highlight(doc, "Consideration")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("DisplayName").displayName}</b>:${searchResult.highlight(doc, "DisplayName")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("PartyRole").displayName}</b>:${searchResult.highlight(doc, "PartyRole")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("DocTypeDesc").displayName}</b>:${searchResult.highlight(doc, "DocTypeDesc")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("Book").displayName}</b>:${searchResult.highlight(doc, "Book")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("Page").displayName}</b>:${searchResult.highlight(doc, "Page")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("OtherName").displayName}</b>:${searchResult.highlight(doc, "OtherName")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("LegalDescription").displayName}</b>:${searchResult.highlight(doc, "LegalDescription")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("FirstReference").displayName}</b>:${searchResult.highlight(doc, "FirstReference")}
      <br/><b>${searchResult.datasetConfiguration.getColumn("LegacyNumber").displayName}</b>:${searchResult.highlight(doc, "LegacyNumber")}

<!--<b>Add to Briefcase</b>:-->
<#if request.isUserInRole('VABEACH_PERPAGE_ACCESS')>
<a class="nocolor" href="search.do?indexName=images&templateName=imagepreview&lq=${pageStyleUtil.encodeURL("Instrument:" + doc.get("Instrument"))}" target="_blank">Preview Image</a>

</#if>
</br>
<#if request.isUserInRole('VABEACH_IMAGE_ACCESS') || request.isUserInRole('VABEACH_ADMIN') || request.isUserInRole('ROAM_ADMIN')>
<a href="javascript:;" onclick="addToCart('indexName?=?${indexName}?=?${dc.displayName}', 'Instrument?=?${doc.get("Instrument")}?con?Instrument?=?${doc.get("Instrument")?replace("'", "\\'")?replace("\"", "\\\"")}?con?${searchResult.datasetConfiguration.getColumn("DocType").displayName}?=?${doc.get("DocType")?replace("'", "\\'")?replace("\"", "\\\"")?trim}', 'Instrument%3A${doc.get("Instrument")}', '25');" >Add to Briefcase</a>
<br/><a class="nocolor" href="search.do?indexName=images&lq=${pageStyleUtil.encodeURL("Instrument:" + doc.get("Instrument"))}" target="_blank">View Image</a>
<br /><b>Add to Cart</b>:
         <input class="cartLink" type="button" title="${doc.get("Instrument")}" value="Add to Cart"/>
</#if>
<br/>&nbsp;
 </#foreach>


<#else>
 <#include "noResults.stl"> 
</#if>



<script type="text/javascript">
$(document).ready(function() {
    oTable = $('#doc').dataTable({
        "bJQueryUI": true,
        "bPaginate": false,
        "bLengthChange": false,
        "bFilter": false,
        "bSort": true,
        "bInfo": false,
        "bAutoWidth": false,
        "aaSorting": []
    });

     $(".cartLink").click(function() {
        var dataString = 'indexName=images&lq=Instrument:' + $(this).attr("title");
        $.ajax({
          type: "POST",
          url: "${request.getContextPath()}/search.do",
          data: dataString,      
          success: function(data) {
            $.each(data, function(i,item){                  
                 if (item.code == "EXISTS") {
                    var txt = item.description + "You can view your purchase using the below link, <br/> <a target='_blank' href='viewPayAsUGoPaymentDetails.admin?webTxId=" + item.moduleName + "'>View Purchase</a>";     
                    $.prompt(txt);
                 } else if (item.code == "SUCCESS") {
                    if (item.count == 0) {
                        $("span#shoppingCartItems").text('  Shopping cart is Empty');
                        $.prompt(item.description);
                    } else {
                        $("span#shoppingCartItems").text('  ' + item.count + ' Item(s) in the Shopping Cart');
                        $.prompt(item.description);
                    }
                 } else {
                    $.prompt(item.description); 
                 }
              });     
          }
        });
          return false;
    });
} );
</script>
